<sql> 
	<view>DROP VIEW IF EXISTS V_CARATULA_DEL;</view>
	<view>
	    CREATE VIEW V_CARATULA_DEL AS 
	   	SELECT ID_N, IVRESFIN_03, VII3_2B,   
       CASE WHEN IVRESFIN_03 IS NULL OR IVRESFIN_03 = 0 THEN 1 ELSE
       CASE WHEN IVRESFIN_03 = 1 THEN
            CASE WHEN VII3_2B IS NULL THEN 1 ELSE 0 END    
       WHEN IVRESFIN_03 IN (4) THEN       
            CASE WHEN GPSLATITUD_DEL IS NULL OR VII3_2B IS NOT NULL THEN 1 ELSE 0 END                        
       WHEN IVRESFIN_03 IN (3,6) THEN       
            CASE WHEN OBS_03_CAR IS NULL OR GPSLATITUD_DEL IS NULL OR VII3_2B IS NOT NULL THEN 1 ELSE 0 END        
       WHEN IVRESFIN_03 IN (5) THEN
            CASE WHEN OBS_03_CAR IS NULL OR VII3_2B IS NULL THEN 1 ELSE 0 END 
       ELSE 1  
       END END AS ESTADO
		FROM [T_DIG_01]
	</view> 
	
	<view>DROP VIEW IF EXISTS V_CAP100_DEL;</view>
	<view>
	    CREATE VIEW V_CAP100_DEL AS 
	   	SELECT A.ID_N, A.II4, A.IVRESFIN_03, B.TOTAL_DELITOS, B.DN121,
       CASE WHEN A.IVRESFIN_03 IS NULL OR A.IVRESFIN_03 = 0 THEN 1 ELSE
       CASE WHEN A.IVRESFIN_03 IN (1) THEN
            CASE WHEN IFNULL(A.II4,0) = 1 AND (IFNULL(B.TOTAL_DELITOS,0) + IFNULL(B.DN121,0) = 0) AND C.ID_N IS NOT NULL THEN 1 ELSE 0 END              
       WHEN A.IVRESFIN_03 IN (4) THEN        
            CASE WHEN IFNULL(A.II4,0) = 1 AND (IFNULL(B.TOTAL_DELITOS,0) + IFNULL(B.DN121,0) != 0) AND C.ID_N IS NOT NULL THEN 1 ELSE 0 END  
       WHEN A.IVRESFIN_03 IN (3,5,6,7) THEN       
            CASE WHEN IFNULL(A.II4,0) = 1 AND (IFNULL(B.TOTAL_DELITOS,0) + IFNULL(B.DN121,0) != 0) AND C.ID_N IS NOT NULL THEN 1 ELSE 0 END
       ELSE 1  
       END END AS ESTADO
		FROM [T_DIG_01] A
    LEFT JOIN T_DIG_03_100 B ON A.ID_N = B.ID_N 
    LEFT JOIN (SELECT DISTINCT ID_N FROM T_DIG_03_200) C ON C.ID_N = A.ID_N 
	</view> 
	
	<view>DROP VIEW IF EXISTS V_CAP200_TD_DEL;</view>
	<view>
	    CREATE VIEW V_CAP200_TD_DEL AS 
	   	SELECT A.ID_N, A.IVRESFIN_03, B.[SUM_FALLECIDOS], B.[TOTAL_DELITOS], B.[CONTE_REG200], C.CANT,
       CASE WHEN A.IVRESFIN_03 IS NULL OR A.IVRESFIN_03 = 0 THEN 1 ELSE
       CASE WHEN A.IVRESFIN_03 IN (1) THEN
            CASE WHEN IFNULL(C.CANT,0) != IFNULL(B.[CONTE_REG200],0) THEN 1 ELSE 0 END              
       WHEN A.IVRESFIN_03 IN (4) THEN        
            CASE WHEN IFNULL(B.[CONTE_REG200],0) != 0 THEN 1 ELSE 0 END  
       WHEN A.IVRESFIN_03 IN (3,5,6,7) THEN       
            CASE WHEN IFNULL(B.[CONTE_REG200],0) != 0 THEN 1 ELSE 0 END 
       ELSE 1  
       END END AS ESTADO
		FROM [T_DIG_01] A
    LEFT JOIN T_DIG_03_100 B ON A.ID_N = B.ID_N  
    LEFT JOIN (SELECT ID_N, COUNT(ID_N) AS CANT FROM T_DIG_03_200 GROUP BY ID_N) C ON C.ID_N = A.ID_N  
	</view> 
	
	<view>DROP VIEW IF EXISTS V_CAP200_V100200_DEL;</view>
	<view>
	    CREATE VIEW V_CAP200_V100200_DEL AS 
	   	SELECT A.ID_N, A.IVRESFIN_03, B.[SUM_FALLECIDOS], B.[CONTE_REG200], C.[CONTE208_1],
       CASE WHEN A.IVRESFIN_03 IS NULL OR A.IVRESFIN_03 = 0 THEN 1 ELSE
       CASE WHEN A.IVRESFIN_03 IN (1) THEN
            CASE WHEN IFNULL(B.[DN101_1_A],0) != IFNULL(C.[CONTE208_1],0) THEN 1
                 WHEN IFNULL(B.[DN101_1_B],0) != IFNULL(C.[CONTE208_2],0) THEN 1                 
                 WHEN IFNULL(B.[DN101_1_C],0) != IFNULL(C.[CONTE208_3],0) THEN 1                 
                 WHEN IFNULL(B.[DN101_1_D],0) != IFNULL(C.[CONTE208_4],0) THEN 1                 
                 WHEN IFNULL(B.[DN101_1_E],0) != IFNULL(C.[CONTE208_5],0) THEN 1                 
                 WHEN IFNULL(B.[DN101_1_F],0) != IFNULL(C.[CONTE208_6],0) THEN 1                 
                 WHEN IFNULL(B.[DN101_1_G],0) != IFNULL(C.[CONTE208_7],0) THEN 1                 
                 WHEN IFNULL(B.[DN101_1_H],0) != IFNULL(C.[CONTE208_8],0) THEN 1
                 WHEN IFNULL(B.[DN101_2],0) != IFNULL(C.[CONTE208_B],0) THEN 1                 
                 WHEN IFNULL(B.[DN101_3],0) != IFNULL(C.[CONTE208_C],0) THEN 1                 
                 WHEN IFNULL(B.[DN101_4],0) != IFNULL(C.[CONTE208_D],0) THEN 1                 
                 WHEN IFNULL(B.[DN101_5],0) != IFNULL(C.[CONTE208_E],0) THEN 1                 
                 WHEN IFNULL(B.[DN101_6],0) != IFNULL(C.[CONTE208_F],0) THEN 1
                 WHEN IFNULL(B.[DN101_7],0) != IFNULL(C.[CONTE208_G],0) THEN 1
                 WHEN IFNULL(B.[DN101_8],0) != IFNULL(C.[CONTE208_H],0) THEN 1
                 WHEN IFNULL(B.[DN101_9],0) != IFNULL(C.[CONTE208_I],0) THEN 1
                 WHEN IFNULL(B.[DN101_10],0) != IFNULL(C.[CONTE208_J],0) THEN 1
                 /*WHEN IFNULL(B.[DN102],0) != IFNULL(C.[CONTE208_102],0) THEN 1
                 WHEN IFNULL(B.[DN103],0) != IFNULL(C.[CONTE208_103],0) THEN 1
                 WHEN IFNULL(B.[DN104],0) != IFNULL(C.[CONTE208_104],0) THEN 1
                 WHEN IFNULL(B.[DN105],0) != IFNULL(C.[CONTE208_105],0) THEN 1
                 WHEN IFNULL(B.[DN106],0) != IFNULL(C.[CONTE208_106],0) THEN 1
                 WHEN IFNULL(B.[DN107],0) != IFNULL(C.[CONTE208_107],0) THEN 1
                 WHEN IFNULL(B.[DN108],0) != IFNULL(C.[CONTE208_108],0) THEN 1
                 WHEN IFNULL(B.[DN109],0) != IFNULL(C.[CONTE208_109],0) THEN 1
                 WHEN IFNULL(B.[DN110],0) != IFNULL(C.[CONTE208_110],0) THEN 1
                 WHEN IFNULL(B.[DN111],0) != IFNULL(C.[CONTE208_111],0) THEN 1
                 WHEN IFNULL(B.[DN112],0) != IFNULL(C.[CONTE208_112],0) THEN 1
                 WHEN IFNULL(B.[DN113],0) != IFNULL(C.[CONTE208_113],0) THEN 1
                 WHEN IFNULL(B.[DN114],0) != IFNULL(C.[CONTE208_114],0) THEN 1
                 WHEN IFNULL(B.[DN115],0) != IFNULL(C.[CONTE208_115],0) THEN 1
                 WHEN IFNULL(B.[DN116],0) != IFNULL(C.[CONTE208_116],0) THEN 1
                 WHEN IFNULL(B.[DN117],0) != IFNULL(C.[CONTE208_117],0) THEN 1
                 WHEN IFNULL(B.[DN118],0) != IFNULL(C.[CONTE208_118],0) THEN 1
                 WHEN IFNULL(B.[DN119],0) != IFNULL(C.[CONTE208_119],0) THEN 1
                 WHEN IFNULL(B.[DN120],0) != IFNULL(C.[CONTE208_120],0) THEN 1*/
             ELSE 0 END              
       WHEN A.IVRESFIN_03 IN (4) THEN        
            CASE WHEN IFNULL(B.[CONTE_REG200],0) != 0 THEN 1 ELSE 0 END  
       WHEN A.IVRESFIN_03 IN (3,5,6,7) THEN       
            CASE WHEN IFNULL(B.[CONTE_REG200],0) != 0 THEN 1 ELSE 0 END 
       ELSE 1  
       END END AS ESTADO
		FROM [T_DIG_01] A
    LEFT JOIN T_DIG_03_100 B ON A.ID_N = B.ID_N     
    LEFT JOIN (SELECT ID_N, SUM(CASE WHEN IFNULL(IH208_COD,IH208)=1 THEN 1 ELSE 0 END) AS CONTE208_1,    
                      SUM(CASE WHEN IFNULL(IH208_COD,IH208)=2 THEN 1 ELSE 0 END) AS CONTE208_2,                      
                      SUM(CASE WHEN IFNULL(IH208_COD,IH208)=3 THEN 1 ELSE 0 END) AS CONTE208_3,                      
                      SUM(CASE WHEN IFNULL(IH208_COD,IH208)=4 THEN 1 ELSE 0 END) AS CONTE208_4,                      
                      SUM(CASE WHEN IFNULL(IH208_COD,IH208)=5 THEN 1 ELSE 0 END) AS CONTE208_5,                      
                      SUM(CASE WHEN IFNULL(IH208_COD,IH208)=6 THEN 1 ELSE 0 END) AS CONTE208_6,                      
                      SUM(CASE WHEN IFNULL(IH208_COD,IH208)=7 THEN 1 ELSE 0 END) AS CONTE208_7,                      
                      SUM(CASE WHEN IFNULL(IH208_COD,IH208)=8 THEN 1 ELSE 0 END) AS CONTE208_8,
                      SUM(CASE WHEN IFNULL(IH208_COD,IH208) IN (9,10,11) THEN 1 ELSE 0 END) AS CONTE208_B,                      
                      SUM(CASE WHEN IFNULL(IH208_COD,IH208)=12 THEN 1 ELSE 0 END) AS CONTE208_C,                      
                      SUM(CASE WHEN IFNULL(IH208_COD,IH208)=13 THEN 1 ELSE 0 END) AS CONTE208_D,                      
                      SUM(CASE WHEN IFNULL(IH208_COD,IH208) IN (14,15,16,17) THEN 1 ELSE 0 END) AS CONTE208_E,                      
                      SUM(CASE WHEN IFNULL(IH208_COD,IH208) IN (18,19,20,21,22,23) THEN 1 ELSE 0 END) AS CONTE208_F,
                      SUM(CASE WHEN IFNULL(IH208_COD,IH208) IN (24) THEN 1 ELSE 0 END) AS CONTE208_G,
                      SUM(CASE WHEN IFNULL(IH208_COD,IH208) IN (25) THEN 1 ELSE 0 END) AS CONTE208_H,
                      SUM(CASE WHEN IFNULL(IH208_COD,IH208) IN (26,27,28,29,30) THEN 1 ELSE 0 END) AS CONTE208_I,
                      SUM(CASE WHEN IFNULL(IH208_COD,IH208) IN (31,32,33,34,35) THEN 1 ELSE 0 END) AS CONTE208_J--,
                      /*SUM(CASE WHEN IH208 IN (36) THEN 1 ELSE 0 END) AS CONTE208_102,
                      SUM(CASE WHEN IH208 IN (37,38,39,40,41) THEN 1 ELSE 0 END) AS CONTE208_103,
                      SUM(CASE WHEN IH208 IN (42,43,44,45,46,47,48,49,50,51,52,53) THEN 1 ELSE 0 END) AS CONTE208_104,
                      SUM(CASE WHEN IH208 IN (54,55,56,57,58,59,60,61,62,63,64,65) THEN 1 ELSE 0 END) AS CONTE208_105,
                      SUM(CASE WHEN IH208 IN (66,67,68,69) THEN 1 ELSE 0 END) AS CONTE208_106,
                      SUM(CASE WHEN IH208 IN (70,71,72) THEN 1 ELSE 0 END) AS CONTE208_107,
                      SUM(CASE WHEN IH208 IN (73) THEN 1 ELSE 0 END) AS CONTE208_108,
                      SUM(CASE WHEN IH208 IN (74,75,76,77,78) THEN 1 ELSE 0 END) AS CONTE208_109,
                      SUM(CASE WHEN IH208 IN (79,80,81) THEN 1 ELSE 0 END) AS CONTE208_110,
                      SUM(CASE WHEN IH208 IN (82,83,84,85) THEN 1 ELSE 0 END) AS CONTE208_111,
                      SUM(CASE WHEN IH208 IN (86,87,88,89,90) THEN 1 ELSE 0 END) AS CONTE208_112,
                      SUM(CASE WHEN IH208 IN (91,92,93,94,95) THEN 1 ELSE 0 END) AS CONTE208_113,
                      SUM(CASE WHEN IH208 IN (96,97,98) THEN 1 ELSE 0 END) AS CONTE208_114,
                      SUM(CASE WHEN IH208 IN (99,100,101,102,103,104) THEN 1 ELSE 0 END) AS CONTE208_115,
                      SUM(CASE WHEN IH208 IN (105,106,107,108) THEN 1 ELSE 0 END) AS CONTE208_116,
                      SUM(CASE WHEN IH208 IN (109,110) THEN 1 ELSE 0 END) AS CONTE208_117,
                      SUM(CASE WHEN IH208 IN (111,112) THEN 1 ELSE 0 END) AS CONTE208_118,
                      SUM(CASE WHEN IH208 IN (113,114,115) THEN 1 ELSE 0 END) AS CONTE208_119,
                      SUM(CASE WHEN IH208 IN (116,117,118) THEN 1 ELSE 0 END) AS CONTE208_120*/
                 FROM T_DIG_03_200 GROUP BY ID_N) C ON A.ID_N = C.ID_N
	</view> 
	
	
	<view>DROP VIEW IF EXISTS V_CAP200_FVO_DEL;</view>
	<view>
	    CREATE VIEW V_CAP200_FVO_DEL AS 
	   	SELECT A.ID_N, A.IVRESFIN_03, B.[SUM_FALLECIDOS], B.[CONTE_REG200],
       CASE WHEN A.IVRESFIN_03 IS NULL OR A.IVRESFIN_03 = 0 THEN 1 ELSE
       CASE WHEN A.IVRESFIN_03 IN (1) THEN
            CASE WHEN IFNULL(C.ACUM, 0) != 0 THEN 1 ELSE 0 END              
       WHEN A.IVRESFIN_03 IN (4) THEN        
            CASE WHEN IFNULL(B.[CONTE_REG200],0) != 0 THEN 1 ELSE 0 END  
       WHEN A.IVRESFIN_03 IN (3,5,6,7) THEN       
            CASE WHEN IFNULL(B.[CONTE_REG200],0) != 0 THEN 1 ELSE 0 END 
       ELSE 1  
       END END AS ESTADO
		FROM [T_DIG_01] A
    LEFT JOIN T_DIG_03_100 B ON A.ID_N = B.ID_N     
    LEFT JOIN (SELECT ID_N, SUM(CASE WHEN ((IFNULL(IH208_COD,IH208) NOT IN (18,19,20,21,22,23) AND IH215 IS NULL) 
                      OR (IFNULL(IH208_COD,IH208) IN (18,19,20,21,22,23) AND IH215 IS NOT NULL)) THEN 1 ELSE 0 END) AS ACUM
              FROM T_DIG_03_200 GROUP BY ID_N) C ON A.ID_N = C.ID_N
	</view>
	
	
	<view>DROP VIEW IF EXISTS V_CAP200_FVA_DEL;</view>
	<view>
	    CREATE VIEW V_CAP200_FVA_DEL AS 
	   	SELECT A.ID_N, A.IVRESFIN_03, B.[SUM_FALLECIDOS], B.[CONTE_REG200],
       CASE WHEN A.IVRESFIN_03 IS NULL OR A.IVRESFIN_03 = 0 THEN 1 ELSE
       CASE WHEN A.IVRESFIN_03 IN (1) THEN
            CASE WHEN IFNULL(C.ACUM, 0) != 0 THEN 1 ELSE 0 END              
       WHEN A.IVRESFIN_03 IN (4) THEN        
            CASE WHEN IFNULL(B.[CONTE_REG200],0) != 0 THEN 1 ELSE 0 END  
       WHEN A.IVRESFIN_03 IN (3,5,6,7) THEN       
            CASE WHEN IFNULL(B.[CONTE_REG200],0) != 0 THEN 1 ELSE 0 END 
       ELSE 1  
       END END AS ESTADO
		FROM [T_DIG_01] A
    LEFT JOIN T_DIG_03_100 B ON A.ID_N = B.ID_N     
    LEFT JOIN (SELECT ID_N, SUM(CASE WHEN IFNULL(IH208_COD,IH208) IS NULL OR IFNULL(IH214, 0) &#60; 1 THEN 1 ELSE 0 END) AS ACUM
              FROM T_DIG_03_200 GROUP BY ID_N) C ON A.ID_N = C.ID_N
	</view>
	
	<view>DROP VIEW IF EXISTS V_CAP300_PC_DEL;</view>
	<view>
	    CREATE VIEW V_CAP300_PC_DEL AS 
	   	SELECT A.ID_N, A.IVRESFIN_03, B.[SUM_IH213], C.[ACUM],
       CASE WHEN A.IVRESFIN_03 IS NULL OR A.IVRESFIN_03 = 0 THEN 1 ELSE
       CASE WHEN A.IVRESFIN_03 IN (1) THEN
            CASE WHEN IFNULL(B.SUM_IH213, 0) != IFNULL(C.ACUM, 0) THEN 1 ELSE 0 END              
       WHEN A.IVRESFIN_03 IN (4) THEN        
            CASE WHEN IFNULL(C.[ACUM],0) != 0 THEN 1 ELSE 0 END  
       WHEN A.IVRESFIN_03 IN (3,5,6,7) THEN       
            CASE WHEN IFNULL(C.[ACUM],0) != 0 THEN 1 ELSE 0 END 
       ELSE 1  
       END END AS ESTADO
		FROM [T_DIG_01] A      
    LEFT JOIN (SELECT ID_N, SUM_IH213 FROM T_DIG_03_100) B ON A.ID_N = B.ID_N     
    LEFT JOIN (SELECT ID_N, COUNT(ID_N) AS ACUM
              FROM T_DIG_03_300 GROUP BY ID_N) C ON A.ID_N = C.ID_N
	</view> 
	
	
	<view>DROP VIEW IF EXISTS V_CAP300_PD_DEL;</view>
	<view>
	    CREATE VIEW V_CAP300_PD_DEL AS 
	   	SELECT A.ID_N, A.IVRESFIN_03, B.[ACUM],
       CASE WHEN A.IVRESFIN_03 IS NULL OR A.IVRESFIN_03 = 0 THEN 1 ELSE
       CASE WHEN A.IVRESFIN_03 IN (1) THEN
            CASE WHEN IFNULL(B.TOT, 0) !=  0 THEN 1 ELSE 0 END              
       WHEN A.IVRESFIN_03 IN (4) THEN        
            CASE WHEN IFNULL(B.[ACUM],0) != 0 THEN 1 ELSE 0 END  
       WHEN A.IVRESFIN_03 IN (3,5,6,7) THEN       
            CASE WHEN IFNULL(B.[ACUM],0) != 0 THEN 1 ELSE 0 END 
       ELSE 1  
       END END AS ESTADO
		FROM [T_DIG_01] A 
    LEFT JOIN (SELECT BB.ID_N, SUM(ACUM) AS ACUM, SUM(CASE WHEN BB.IH214 != IFNULL(CC.ACUM,0) THEN 1 ELSE 0 END) AS TOT FROM T_DIG_03_200 BB  
              LEFT JOIN (SELECT ID_N, NRO_MREG, COUNT(ID_N) AS ACUM FROM T_DIG_03_300 
              GROUP BY ID_N, NRO_MREG) CC ON CC.ID_N=BB.ID_N AND CC.NRO_MREG=BB.NRO_MREG              
              GROUP BY BB.ID_N
              ) B ON A.ID_N = B.ID_N  
	</view> 
	
	
	<view>DROP VIEW IF EXISTS V_CAP300_PVF_DEL;</view>
	<view>
	    CREATE VIEW V_CAP300_PVF_DEL AS 
	   	SELECT A.ID_N, A.IVRESFIN_03, C.[IVH305], AA.[SUM_IH213], AA.TOTAL_DELITOS,
       CASE WHEN A.IVRESFIN_03 IS NULL OR A.IVRESFIN_03 = 0 THEN 1 ELSE
       CASE WHEN A.IVRESFIN_03 IN (1) THEN
            CASE WHEN IFNULL(A.II4,0) = 1 AND IFNULL(AA.TOTAL_DELITOS,0) != 0 AND IFNULL(AA.SUM_IH213,0) = 0 THEN 1 
                 WHEN IFNULL(A.II4,0) = 1 AND IFNULL(AA.TOTAL_DELITOS,0) = 0 AND IFNULL(AA.SUM_IH213,0) != 0 THEN 1 
                 WHEN IFNULL(AA.SUM_IH213,0) != IFNULL(C.IVH305, 0) THEN 1 ELSE 0 END            
       WHEN A.IVRESFIN_03 IN (4) THEN        
            CASE WHEN IFNULL(AA.[SUM_IH213],0) != 0 THEN 1 ELSE 0 END  
       WHEN A.IVRESFIN_03 IN (3,5,6,7) THEN       
            CASE WHEN IFNULL(AA.[SUM_IH213],0) != 0 THEN 1 ELSE 0 END 
       ELSE 1  
       END END AS ESTADO
		FROM [T_DIG_01] A 
    LEFT JOIN (SELECT ID_N, SUM_FALLECIDOS, TOTAL_DELITOS, SUM_IH213 FROM T_DIG_03_100) AA ON A.ID_N = AA.ID_N      
    LEFT JOIN (SELECT C.ID_N, COUNT(C.ID_N) AS IVH305 FROM T_DIG_03_300 C
    		 	INNER JOIN (SELECT ID_N, NRO_MREG, IH215 FROM T_DIG_03_200) D ON D.ID_N = C.ID_N AND D.NRO_MREG = C.NRO_MREG
	            WHERE IVH304 IS NOT NULL 
	            AND (IH215 IS NOT NULL 
		            AND ((IVH304 = 1 AND IVH306_ANIO IS NOT NULL AND IVH310 IS NOT NULL)
		            	OR (IVH304 = 2 AND IVH307 IS NOT NULL AND IVH310 IS NOT NULL)
		            	OR (IVH304 IN (3,4) AND IVH307 IS NOT NULL AND IVH310 IS NOT NULL))
		        ) OR (IH215 IS NULL 
		        	AND ((IVH304 = 1 AND IVH306_ANIO IS NOT NULL)
		            	OR (IVH304 = 2 AND IVH307 IS NOT NULL)
		            	OR (IVH304 IN (3,4) AND IVH308 IS NOT NULL AND IVH309 IS NOT NULL))
		        )
	           GROUP BY C.ID_N) C ON A.ID_N = C.ID_N    
	</view> 
	
	<view>DROP VIEW IF EXISTS V_CAP400_PC_DEL;</view>
	<view>
	    CREATE VIEW V_CAP400_PC_DEL AS 
	   	SELECT A.ID_N, A.IVRESFIN_03, B.[SUM214],
       CASE WHEN A.IVRESFIN_03 IS NULL OR A.IVRESFIN_03 = 0 THEN 1 ELSE
       CASE WHEN A.IVRESFIN_03 IN (1) THEN
            CASE WHEN IFNULL(B.SUM214, 0) != IFNULL(C.ACUM, 0) THEN 1 ELSE 0 END              
       WHEN A.IVRESFIN_03 IN (4) THEN        
            CASE WHEN IFNULL(C.[ACUM],0) != 0 THEN 1 ELSE 0 END  
       WHEN A.IVRESFIN_03 IN (3,5,6,7) THEN       
            CASE WHEN IFNULL(C.[ACUM],0) != 0 THEN 1 ELSE 0 END 
       ELSE 1  
       END END AS ESTADO
		FROM [T_DIG_01] A      
    LEFT JOIN (SELECT ID_N, SUM(SUM_IH214) AS SUM214 FROM T_DIG_03_100
              GROUP BY ID_N) B ON A.ID_N = B.ID_N     
    LEFT JOIN (SELECT ID_N, COUNT(ID_N) AS ACUM
              FROM T_DIG_03_400 GROUP BY ID_N) C ON A.ID_N = C.ID_N    
	</view> 
	
	
	<view>DROP VIEW IF EXISTS V_CAP400_PD_DEL;</view>
	<view>
	    CREATE VIEW V_CAP400_PD_DEL AS 
	   	SELECT A.ID_N, A.IVRESFIN_03, B.[ACUM],
       CASE WHEN A.IVRESFIN_03 IS NULL OR A.IVRESFIN_03 = 0 THEN 1 ELSE
       CASE WHEN A.IVRESFIN_03 IN (1) THEN
            CASE WHEN IFNULL(B.TOT, 0) !=  0 THEN 1 ELSE 0 END              
       WHEN A.IVRESFIN_03 IN (4) THEN        
            CASE WHEN IFNULL(B.[ACUM],0) != 0 THEN 1 ELSE 0 END  
       WHEN A.IVRESFIN_03 IN (3,5,6,7) THEN       
            CASE WHEN IFNULL(B.[ACUM],0) != 0 THEN 1 ELSE 0 END 
       ELSE 1  
       END END AS ESTADO
		FROM [T_DIG_01] A     
    LEFT JOIN (SELECT BB.ID_N, SUM(ACUM) AS ACUM, SUM(CASE WHEN BB.IH215 != IFNULL(CC.ACUM,0) THEN 1 ELSE 0 END) AS TOT FROM T_DIG_03_200 BB  
              LEFT JOIN (SELECT ID_N, NRO_MREG, COUNT(ID_N) AS ACUM FROM T_DIG_03_400 
              GROUP BY ID_N, NRO_MREG) CC ON CC.ID_N=BB.ID_N AND CC.NRO_MREG=BB.NRO_MREG              
              GROUP BY BB.ID_N
              ) B ON A.ID_N = B.ID_N     
	</view> 
	
	
	<view>DROP VIEW IF EXISTS V_CAP400_PV_DEL;</view>
	<view>
	    CREATE VIEW V_CAP400_PV_DEL AS 
	   	SELECT A.ID_N, A.IVRESFIN_03, C.IVM408, C.ACUM, B.SUM_IH214,
       CASE WHEN A.IVRESFIN_03 IS NULL OR A.IVRESFIN_03 = 0 THEN 1 ELSE
       CASE WHEN A.IVRESFIN_03 IN (1) THEN
           CASE WHEN IFNULL(B.[SUM_IH214],0) != IFNULL(C.IVM408,0) THEN 1 ELSE 0 END              
       WHEN A.IVRESFIN_03 IN (4) THEN        
            CASE WHEN IFNULL(C.[ACUM],0) != 0 THEN 1 ELSE 0 END  
       WHEN A.IVRESFIN_03 IN (3,5,6,7) THEN       
            CASE WHEN IFNULL(C.[ACUM],0) != 0 THEN 1 ELSE 0 END 
       ELSE 1  
       END END AS ESTADO
		FROM [T_DIG_01] A         
    LEFT JOIN (SELECT ID_N, SUM_IH214 FROM T_DIG_03_100) B ON A.ID_N = B.ID_N                 
    LEFT JOIN (SELECT ID_N, COUNT(ID_N) AS ACUM, 
              SUM(CASE WHEN IVM408 IS NOT NULL THEN 1 ELSE 0 END) AS IVM408 FROM T_DIG_03_400
              GROUP BY ID_N) C ON A.ID_N = C.ID_N    
	</view> 
	
</sql> 
