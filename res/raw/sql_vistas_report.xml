<sql>	
    <view>DROP VIEW IF EXISTS V_REPORT_001;</view>
	<view>
	    CREATE VIEW V_REPORT_001 AS
	    SELECT C.ID_N, D.TOTAL_DELITOS, D.DN121, D.SUM_FALLECIDOS, IFNULL(E.TOT200,0) AS TOT200 FROM T_DIG_01 C
		INNER JOIN (SELECT ID_N, TOTAL_DELITOS, SUM_FALLECIDOS, DN121 FROM T_DIG_03_100) D ON D.ID_N = C.ID_N
		LEFT JOIN (SELECT ID_N, COUNT(ID_N) AS TOT200 FROM T_DIG_03_200 
		                  GROUP BY ID_N) E ON E.ID_N = C.ID_N
	</view>  
	<view>DROP VIEW IF EXISTS V_REPORT_002;</view>
	<view>
	    CREATE VIEW V_REPORT_002 AS
		SELECT C.ID_N, E.NRO_MREG, E.ORDEN_200, IFNULL(E.IH214, '--') AS IH214, IFNULL(E.IH215, '--') AS IH215,
		IFNULL(F.TOT300,0) AS TOT300, IFNULL(G.TOT400,0) AS TOT400 FROM T_DIG_01 C
		INNER JOIN (SELECT ID_N, NRO_MREG, ORDEN_200, IH214, IH215 FROM T_DIG_03_200) E ON E.ID_N = C.ID_N
		LEFT JOIN (SELECT ID_N, NRO_MREG, COUNT(ID_N) AS TOT300 FROM T_DIG_03_300
		                  GROUP BY ID_N, NRO_MREG) F ON F.ID_N = E.ID_N AND F.NRO_MREG = E.NRO_MREG
		LEFT JOIN (SELECT ID_N, NRO_MREG, COUNT(ID_N) AS TOT400 FROM T_DIG_03_400
		                  GROUP BY ID_N, NRO_MREG) G ON G.ID_N = E.ID_N AND G.NRO_MREG = E.NRO_MREG
	</view> 
	<view>DROP VIEW IF EXISTS V_REPORT_003;</view>
	<view>
	    CREATE VIEW V_REPORT_003 AS
		SELECT C.ID_N, C.NRO_MREG, C.ORDEN_300, C.IVH301A||' '||C.IVH301B||' '||C.IVH301C AS NOMBRE FROM T_DIG_03_300 C
		INNER JOIN (SELECT ID_N, NRO_MREG FROM T_DIG_03_200) B ON B.ID_N = C.ID_N AND B.NRO_MREG = C.NRO_MREG 
	</view>   
	<view>DROP VIEW IF EXISTS V_REPORT_004;</view>
	<view>
	    CREATE VIEW V_REPORT_004 AS
		SELECT C.ID_N, C.NRO_MREG, C.ORDEN_400, C.IVM401A||' '||C.IVM401B||' '||C.IVM401C AS NOMBRE FROM T_DIG_03_400 C
		INNER JOIN (SELECT ID_N, NRO_MREG FROM T_DIG_03_200) B ON B.ID_N = C.ID_N AND B.NRO_MREG = C.NRO_MREG 
	</view> 
	<view>DROP VIEW IF EXISTS V_REPORT_005;</view>
	<view>
	    CREATE VIEW V_REPORT_005 AS
	    SELECT ID_N, I11_3 AS NOMBRE, IVRESFIN_03 AS RESFIN,  
	    CASE WHEN GPSLONGITUD_DEL IS NULL OR LENGTH(GPSLONGITUD_DEL) = 0 THEN 'NO'
	    	 WHEN GPSLONGITUD_DEL = '9999999999' THEN 'OMISION' ELSE 'SI' END AS GPS FROM T_DIG_01
	</view>   
	<view>DROP VIEW IF EXISTS V_REPORT_006;</view>
	<view>
	    CREATE VIEW V_REPORT_006 AS
	    SELECT ID_N, DN101, DN102, DN103, DN104, DN105, DN106, DN107, DN108, DN109, DN110, DN111, DN112, 
	    DN113, DN114, DN115, DN116, DN117, DN118, DN119, DN120, FALTAS FROM T_DIG_03_100
	</view>  
</sql> 
